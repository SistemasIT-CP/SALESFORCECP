<template>
    <lightning-card title="Inicio de anfitrión" icon-name="custom:custom14">
        <div class="slds-m-around_small" style="width:100%">
            <div class="slds-m-vertical_medium slds-align_absolute-center">
                <template if:true={welcomeScreen}>
                    <div class= "slds-grid slds-gutters">
                        <div class="slds-col">
                           <button class="slds-button" name="Cliente nuevo"
                                 style="width:226px; 
                                       height:64px; 
                                       font-size:25px; 
                                       color:white;
                                       background-color: rgb(214, 5, 1); 
                                       border: rgb(214, 5, 1);" 
                                 onclick={handleclick}>
                                    <span style="text-align:center; width:100%; pointer-events:none;">Cliente nuevo</span>
                           </button>
                        </div>
                        <div class="slds-col">
                           <button class="slds-button" name="Ya es cliente"
                                    style="width:226px; 
                                          height:64px; 
                                          font-size:25px; 
                                          text-align:center;
                                          color:white;
                                          background-color: rgb(214, 5, 1); 
                                          border: rgb(214, 5, 1);"
                                    onclick={handleclick}>
                                       <span style="text-align:center; width:100%; pointer-events:none;">Ya es cliente</span>
                           </button>
                        </div>
                    </div>
                </template>

                <template if:true={newClient}>
                  <div style="width: 90%;">
                     <form>
                        <div class="slds-form-element">
                           <div class= "slds-grid slds-gutters">
                              <div class="slds-col">
                                 <label class="slds-form-element__label" for="nombre">
                                    Nombre
                                 </label>
                                 <div class="slds-form-element__control">
                                    <input type="text" id="nombre" placeholder="Nombre" class="slds-input" />
                                 </div>
                                 <label class="slds-form-element__label" for="segundoNombre">
                                    Segundo nombre
                                 </label>
                                 <div class="slds-form-element__control">
                                    <input type="text" id="segundoNombre" placeholder="Segundo nombre" class="slds-input" />
                                 </div>
                                 <label class="slds-form-element__label" for="apellidos">
                                    <abbr class="slds-required" title="required">* </abbr>Apellidos
                                 </label>
                                 <div class="slds-form-element__control">
                                    <input type="text" id="apellidos" placeholder="Apellidos" required="" class="slds-input" />
                                 </div>
                                 <label class="slds-form-element__label" for="correoElectronico">
                                    Correo electrónico
                                 </label>
                                 <div class="slds-form-element__control">
                                    <input type="text" id="correoElectronico" placeholder="" class="slds-input" />
                                 </div>
                                 <label class="slds-form-element__label" for="telefono">
                                    <abbr class="slds-required" title="required">* </abbr>Teléfono
                                 </label>
                                 <div class="slds-form-element__control">
                                    <input type="text" id="telefono" placeholder="" class="slds-input" />
                                 </div>
                                 <label class="slds-form-element__label" for="cedula">
                                    Identificación
                                 </label>
                                 <div class="slds-form-element__control">
                                    <input type="text" id="cedula" placeholder="" class="slds-input" />
                                 </div>
                              </div>
                              <div class="slds-col">
                                 <label class="slds-form-element__label" for="sucursal">
                                    <abbr class="slds-required" title="required">* </abbr>Sucursal
                                 </label>
                                 <div class="slds-form-element__control">
                                    <div class="slds-select_container">
                                       <select class="slds-select" required="" id="sucursal" onchange={changeSucursal}>
                                          <option value=""></option>
                                          <template for:each={sucursalesOptions} for:item="sucursal">
                                             <option key={sucursal}>{sucursal}</option>
                                          </template>
                                       </select>
                                    </div>
                                 </div>
                                 <label class="slds-form-element__label" for="vendedor">
                                    <abbr class="slds-required" title="required">* </abbr>Vendedor
                                 </label>
                                 <div class="slds-form-element__control">
                                    <div class="slds-select_container">
                                       <select class="slds-select" required="" id="vendedor">
                                          <template for:each={userOptions} for:item="vendedor">
                                             <option key={vendedor.Id}>{vendedor.Name}</option>
                                          </template>
                                       </select>
                                    </div>
                                 </div>
                                 <label class="slds-form-element__label" for="marca">
                                    <abbr class="slds-required" title="required">* </abbr>Marca
                                 </label>
                                 <div class="slds-form-element__control">
                                    <div class="slds-select_container">
                                       <select class="slds-select" id="marca" onchange={changeMarca}>
                                          <option value=""></option>
                                          <template for:each={marcasOptions} for:item="marca">
                                             <option key={marca}>{marca}</option>
                                          </template>
                                       </select>
                                    </div>
                                 </div>
                                 <label class="slds-form-element__label" for="modelo">
                                    <abbr class="slds-required" title="required">* </abbr>Modelo
                                 </label>
                                 <div class="slds-form-element__control">
                                    <div class="slds-select_container">
                                       <select class="slds-select" id="modelo">
                                          <template for:each={modelosOptions} for:item="modelo">
                                             <option key={modelo}>{modelo}</option>
                                          </template>
                                       </select>
                                    </div>
                                 </div>
                              </div>
                           </div>

                           <div style="float: right; margin: 10px 0px;">
                              <button class="slds-button slds-button_outline-brand" style="padding: 0px 10px; width:113px; height:32px;" name="Inicio" onclick={handleclick}>
                                 Inicio
                              </button>
                              <input class="slds-button slds-button_brand" style="padding: 0px 10px; width:113px; height:32px;" type="submit" value="Guardar" onclick={createLead}/>
                           </div>
                        </div>
                     </form>
                  </div>
                </template>

                <template if:true={oldClient}>
                    <div style="width: 90%;">
                        <div class="slds-m-bottom_small">
                            <lightning-input type="text"
                               value={searchValue}
                               label="Nombre o Código de cliente"
                               onchange={searchKeyword}
                               ></lightning-input>
                        </div>

                        <button class="slds-button slds-button_brand" style="padding: 0px 10px; width:113px; height:32px;" name="Buscar" onclick={handleSearchKeyword}>
                           Buscar
                        </button>
                         
                           <div style="max-height: 250px; overflow-y: auto; padding: 10px 0px;">
                              <lightning-datatable
                                 key-field="id"
                                 data={opportunitiesList}
                                 columns={columns} 
                                 onrowselection={selectRow}
                               >
                              </lightning-datatable>
                           </div>

                           <div style="float: right; margin: 10px 0px;">
                              <button class="slds-button slds-button_outline-brand" style="padding: 0px 10px; width:113px; height:32px;" name="Inicio" onclick={handleclick}>
                                 Inicio
                              </button>
                              <button class="slds-button slds-button_brand" style="padding: 0px 10px; width:190px; height:32px;" name="Ninguna oportunidad aplica" onclick={handleclick}>
                                 Ninguna oportunidad aplica
                              </button>
                              <button class="slds-button slds-button_brand" style="padding: 0px 10px; width:113px; height:32px;" name="Siguiente" disabled={disabledNext} onclick={editOpportunity}>
                                 Siguiente
                              </button>
                           </div>
                      </div>
                </template>

                <template if:true={editOpp}>
                  <div style="width: 90%; z-index:1; margin: 0 auto;">
                     <lightning-record-edit-form
                        object-api-name="Opportunity"
                        record-id={selectedOpp}
                        onsuccess={handleSuccess}
                        onerror={errorHandler}
                        onload={loadManager}
                     >
                        <lightning-input-field field-name="Tipo_de_visita__c">\ </lightning-input-field>
                        <lightning-input-field field-name="Comentario_Anfitri_n__c"> </lightning-input-field>
                        <lightning-input-field class="fecha" field-name="Fecha_de_visita__c"> </lightning-input-field>

                        <div class="slds-align_absolute-center">
                           <button class="slds-button slds-button_outline-brand" style="padding: 0px 10px; width:113px; height:32px;" disabled={disabledEdition} name="Inicio" onclick={handleclick}>
                              Inicio
                           </button>
                           <button class="slds-button slds-button_brand" style="padding: 0px 10px; width:113px; height:32px;" disabled={disabledEdition} name="Actualizar" onclick={actualizarRegistro}>
                              Actualizar
                           </button>
                        </div>
                     </lightning-record-edit-form>
                  </div>
               </template>
               
               <template if:true={loaded}>
                  <div style="width: 90%; height: 150px; z-index:2;">
                     <lightning-spinner alternative-text="Cargando..." size="medium"></lightning-spinner>
                  </div>
               </template>
               
               <template if:true={leadRedirect}>
                  <div style="width: 90%; height: 150px;">
                     <div class="slds-m-vertical_medium slds-align_absolute-center">
                        <div class= "slds-grid slds-gutters">
                           <div class="slds-col">
                              <button class="slds-button slds-button_outline-brand" style="padding: 0px 10px; width:113px; height:32px;" name="Inicio" onclick={handleclick}>
                                 Inicio
                              </button>
                           </div>
                           <div class="slds-col">
                              <button class="slds-button slds-button_brand" style="padding: 0px 10px; width:113px; height:32px;" name="Ir al Lead" onclick={handleclick}>
                                 Ir al Lead
                              </button>
                           </div>
                        </div>
                     </div>
                  </div>
               </template>
            </div>
        </div>
    </lightning-card>
</template>